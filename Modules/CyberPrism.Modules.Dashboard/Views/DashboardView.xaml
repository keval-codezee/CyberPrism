<UserControl x:Class="CyberPrism.Modules.Dashboard.Views.DashboardView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:prism="http://prismlibrary.com/"
             xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
             xmlns:local="clr-namespace:CyberPrism.Modules.Dashboard.Views"
             xmlns:core="clr-namespace:CyberPrism.Core.Views;assembly=CyberPrism.Core"
             prism:ViewModelLocator.AutoWireViewModel="True">
    <Grid>
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">
                <TextBlock Text="{Binding Title}" FontSize="32" FontWeight="Bold" Foreground="White" VerticalAlignment="Center"/>
                
                <!-- EventAggregator Demo: System Status Indicator -->
                <Border Background="#33FFFFFF" CornerRadius="15" Margin="30,0,0,0" Padding="15,5">
                    <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                        <Ellipse Width="10" Height="10" Fill="{Binding SystemStatusColor}" Margin="0,0,10,0" VerticalAlignment="Center"/>
                        <TextBlock Text="{Binding SystemStatus}" Foreground="White" FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"/>
                    </StackPanel>
                </Border>
            </StackPanel>

            <!-- Content Grid -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="1*" />
                    <ColumnDefinition Width="1*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="1*" />
                    <RowDefinition Height="1*" />
                </Grid.RowDefinitions>

                <!-- 1. Monthly Summary -->
                <local:MonthlySummary Grid.Row="0" Grid.Column="0"/>

                <!-- 2. Product Quality -->
                <local:ProductQuality Grid.Row="0" Grid.Column="1" Grid.ColumnSpan="2"/>

                <!-- 3. Key Metrics -->
                <local:KeyMetrics Grid.Row="1" Grid.Column="0"/>

                <!-- 4. Performance (Power & Performance combined) -->
                <local:PerformanceMonitor Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2"/>
            </Grid>
        </Grid>

        <!-- Connection Error Overlay -->
        <core:ConnectionErrorView Visibility="{Binding IsConnected, Converter={StaticResource InverseBooleanToVisibilityConverter}}"/>
    </Grid>
</UserControl>
